# Product Requirements Document (PRD)
**Project Name:** Multi-Channel Engagement (MCE) Platform
**Version:** 1.0 (Draft)
**Date:** 2025-12-28
**Status:** Draft / Review Required

## 1. Executive Summary
The MCE Platform is a centralized lead management and engagement system designed to streamline communication with potential customers. It combines real-time lead ingestion, automated workflows, and multi-channel messaging (primarily WhatsApp) into a single, cohesive dashboard.

## 2. Problem Statement
Businesses struggle to manage leads coming from disparate sources (CSV, Sheets, Webhooks) and fail to engage them instantly. Manual follow-ups are slow and inconsistent, leading to lost conversion opportunities.

## 3. Goals & Objectives
*   **Centralization:** Aggregate leads from all sources into one view.
*   **Speed:** Enable real-time or near real-time engagement with new leads.
*   **Automation:** Reduce manual workload through trigger-based workflows (e.g., auto-replies).
*   **Visibility:** Provide clear analytics on lead performance and engagement metrics.

## 4. Functional Requirements

### 4.1. Dashboard & Analytics
*   **Overview Stats:** Display key metrics: Total Leads, Active Leads, Conversion Rate, Response Rate.
*   **Performance Chart:** Visual trend of lead acquisition/conversion over time (e.g., Line/Area chart).
*   **Live Feed:** Real-time stream of incoming leads and system activities (e.g., "New lead from Campaign A").
*   **Real-time Updates:** Dashboard should refresh automatically (polling or socket) to show latest data.

### 4.2. Lead Management
*   **Ingestion:**
    *   **CSV Import:** Capability to upload bulk leads via CSV.
    *   **Google Sheets Polling:** Automatically fetch new rows from configured Google Sheets.
    *   **Webhooks:** API endpoint (`/api/hooks`) to receive leads from external forms/ads.
*   **Lead List:** View all leads with details (Name, Source, Status, Score, Timestamp).
*   **Lead Details:** "Lead Card" view showing specific attributes of a lead.

### 4.3. Communication (WhatsApp Integration)
*   **Connection:**
    *   Integration with `whatsapp-web.js` for browser-less automation.
    *   QR Code generation/display for linking a device.
*   **Chat Interface:**
    *   **Chat Window:** Embedded chat UI to view conversation history with a specific lead.
    *   **Send Message:** Ability to send text template messages manually.
    *   **Status Indicators:** Tracking message status (Sent, Delivered, Read).

### 4.4. Campaigns & Broadcasts
*   **Campaign Management:** Create and manage distinct outreach campaigns.
*   **Bulk Messaging:** Ability to send messages to a filtered list of leads.
*   **Scheduling:** (Implicit) send messages at optimized times or intervals.

### 4.5. Automation & Workflows
*   **Workflow Builder:** Define rules for automatic actions.
    *   *Trigger:* On Lead Created, On Status Change.
    *   *Action:* Send WhatsApp Message, Update Score, Notify Admin.
*   **Lead Scoring:** Assign scores based on lead source or interactions (suggested by `score` field in code).

## 5. Technical Architecture

### 5.1. Tech Stack
*   **Frontend:**
    *   Framework: **Next.js 16** (App Router)
    *   UI Library: **React 19**
    *   Styling: **TailwindCSS 4**
    *   Icons: Lucide React
    *   Charts: Recharts
    *   Animations: Framer Motion
*   **Backend:**
    *   Runtime: **Node.js**
    *   Server Framework: **Express.js**
    *   Database: **SQLite** (`mce.db`)
    *   Queues: BullMQ (for handling background jobs/message queues)
*   **Integrations:**
    *   **WhatsApp:** `whatsapp-web.js` (Local Puppeteer-based automation)
    *   **Twilio:** (Dependency present, likely for SMS fallback or verification)
    *   **Google:** `google-libphonenumber` for number formatting.

### 5.2. Data Models (Key Entities)
*   **Leads:** `id`, `name`, `phone`, `source`, `status`, `score`, `created_at`, `metadata`.
*   **Messages:** `id`, `lead_id`, `content`, `direction` (inbound/outbound), `status`, `timestamp`.
*   **Campaigns:** `id`, `name`, `template_id`, `schedule`, `status`.
*   **Workflows:** `id`, `trigger_type`, `action_config`, `active`.

## 6. Non-Functional Requirements
*   **Performance:** Dashboard load time < 2s. Real-time feed latency < 5s.
*   **Reliability:** WhatsApp service must auto-recover from disconnections.
*   **Data Integrity:** Prevent duplicate leads from same phone number (deduplication logic).

## 7. Assumptions & Constraints
*   **WhatsApp Auth:** Relies on a persistent session (`.wwebjs_auth`); requires periodic re-scanning if session expires.
*   **Local Storage:** Uses SQLite, so horizontal scaling is limited (suitable for single-instance deployment).
*   **Hosting:** Currently designed for local/VPS execution due to Puppeteer dependency.

---
*Generated by Antigravity based on existing codebase analysis.*
